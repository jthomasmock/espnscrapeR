#' Get ESPN's WR metrics from FiveThirtyEight
#'
#'
#' @return tibble
#' @export
#'
#' @section Examples:
#'
#' ```r
#' raw_metrics <- espnscrapeR::get_espn_wr_metrics()
#'
#' dplyr::glimpse(raw_metrics)
#'
#' #> Rows: 1,657
#' #> Columns: 20
#' #> $ gsis_id           <chr> "00-0035676", "00-0030506", "00-0033040", "00…
#' #> $ position          <chr> "WR", "TE", "WR", "WR", "WR", "WR", "WR", "TE…
#' #> $ tm                <chr> "PHI", "KC", "MIA", "BUF", "SEA", "CIN", "NO"…
#' #> $ overall           <int> 86, 81, 80, 79, 78, 75, 75, 74, 74, 73, 73, 7…
#' #> $ open_score        <int> 88, 80, 86, 73, 90, 73, 83, 64, 78, 73, 77, 6…
#' #> $ catch_score       <int> 56, 76, 69, 78, 81, 53, 67, 65, 62, 65, 53, 6…
#' #> $ yac_score         <int> 72, 47, 45, 50, 22, 70, 41, 68, 51, 54, 60, 5…
#' #> $ rtm_routes        <int> 198, 216, 244, 236, 241, 286, 219, 179, 253, …
#' #> $ rtm_targets       <int> 60, 55, 82, 65, 61, 68, 63, 37, 66, 43, 48, 4…
#' #> $ min_season        <int> 2022, 2022, 2022, 2022, 2022, 2022, 2022, 202…
#' #> $ max_season        <int> 2022, 2022, 2022, 2022, 2022, 2022, 2022, 202…
#' #> $ min_player_season <int> 2022, 2022, 2022, 2022, 2022, 2022, 2022, 202…
#' #> $ max_player_season <int> 2022, 2022, 2022, 2022, 2022, 2022, 2022, 202…
#' #> $ min_rtm_targets   <int> 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 2…
#' #> $ dot_com_id        <chr> "4047646", "15847", "3116406", "2976212", "25…
#' #> $ first_nm          <chr> "A.J.", "Travis", "Tyreek", "Stefon", "Tyler"…
#' #> $ last_nm           <chr> "Brown", "Kelce", "Hill", "Diggs", "Lockett",…
#' #> $ full_nm           <chr> "A.J. Brown", "Travis Kelce", "Tyreek Hill", …
#' #> $ team_name         <chr> "Philadelphia Eagles", "Kansas City Chiefs", …
#' #> $ yds               <int> 659, 553, 961, 764, 531, 605, 547, 418, 752, …
#' ```
get_espn_wr_metrics <- function(){

  in_url <- "https://projects.fivethirtyeight.com/nfl-receiver-rankings/data.json"

  raw_json <- jsonlite::fromJSON(in_url, simplifyVector = FALSE)

  dplyr::tibble(data = raw_json[["rtm_data"]]) |>
    tidyr::unnest_wider(data)

}
